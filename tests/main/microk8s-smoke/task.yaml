summary: Smoke test for microk8s

environment:
    CHANNEL/edge: latest/edge/strict

execute: |
    snap install --channel="$CHANNEL" microk8s
    microk8s status --wait-ready
    # XXX: enable dashboard etc? doing this is slow :/
    #microk8s enable dashboard dns registry istio
    microk8s kubectl get nodes | MATCH Ready
    microk8s kubectl get services | MATCH kubernetes
    
    microk8s kubectl create deployment nginx --image=nginx
    retry -n 20 microk8s kubectl get pods | MATCH Running
    # XXX: test if ngix can be connected

    
    
